{"remainingRequest":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!c:\\person_data\\demo\\Vue-demo\\sell\\src\\components\\goods\\goods.vue?vue&type=script&lang=js&","dependencies":[{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\src\\components\\goods\\goods.vue","mtime":1555420895241},{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport Scroll from 'better-scroll'\r\nimport cartcontrol from '../cartcontrol/cartcontrol.vue'\r\nimport food from '../food/food.vue'\r\n\r\nconst ERROK = 0\r\n\r\nexport default {\r\n  props: {\r\n    seller: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    //已选择的食品\r\n    selectfoods: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    //shopcart组件实例\r\n    shopcartComponent: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      //异步从服务器get数据\r\n      goods: [],\r\n      //不同的type映射到不同的class\r\n      classMap: ['decrease', 'discount', 'special', 'invoice', 'guarantee'],\r\n      //存放右侧栏目高度\r\n      heightArray: [],\r\n      //当前滚动高度\r\n      currentHeight: 0,\r\n      //进入食品详情页时该食品的数据\r\n      selectedFood: {},\r\n      //食品详情页是否显示\r\n      show: false\r\n    }\r\n  },\r\n  created: function () {\r\n    this.$http.get('/api/goods')\r\n    .then((res) => {\r\n      if (res.data.errno === ERROK) {\r\n        this.goods = res.data.data\r\n      }\r\n      else new Error()\r\n    })\r\n    .catch((error) => {\r\n      console.log(error)\r\n    })\r\n  },\r\n  mounted: function () {\r\n      this.scrollMenu = new Scroll(this.$refs.menu, {\r\n        click: true\r\n      })\r\n\r\n      this.scrollFood = new Scroll(this.$refs.food, {\r\n        click: true,\r\n        probeType: 3\r\n      })\r\n      this.scrollFood.on('scroll', (pos) => {\r\n        this.currentHeight = Math.abs(pos.y)\r\n      })\r\n  },\r\n  computed: {\r\n    leftIndex: function () {\r\n      for (let i = 0; i < this.heightArray.length; i++) {\r\n        if (this.heightArray[i + 1] && this.currentHeight >= this.heightArray[i] && this.currentHeight < this.heightArray[i + 1]) {\r\n          return i\r\n        }\r\n      }\r\n      return 0\r\n    }\r\n  },\r\n  watch: {\r\n    goods: function() {\r\n      this.$nextTick(() => {\r\n        let foodList = this.$refs.fooditem, addHeight = 0\r\n        this.heightArray.push(0)\r\n        for (let i = 0; i < foodList.length; i++) {\r\n          addHeight += foodList[i].clientHeight\r\n          this.heightArray.push(addHeight)\r\n        }\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    scrollto: function (index, event) {\r\n      if (!event._constructed) {\r\n        return\r\n      }\r\n      else {\r\n        const foods = this.$refs.fooditem\r\n        let target = foods[index]\r\n        this.scrollFood.scrollToElement(target, 400)\r\n      }\r\n    },\r\n    drop: function (el) {\r\n      this.shopcartComponent.dropball(el)\r\n    },\r\n    selectFood: function (food) {\r\n      if (food) {\r\n        this.selectedFood = food\r\n      }\r\n      this.show = !this.show\r\n    }\r\n  },\r\n  components: {\r\n    cartcontrol,\r\n    food\r\n  }\r\n}\r\n",null]}