{"remainingRequest":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!c:\\person_data\\demo\\Vue-demo\\sell\\src\\components\\ratinglist\\ratinglist.vue?vue&type=script&lang=js&","dependencies":[{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\src\\components\\ratinglist\\ratinglist.vue","mtime":1555680847788},{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"c:\\person_data\\demo\\Vue-demo\\sell\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport Bus from '../Bus/Bus.js'\r\n\r\nconst ALL = \"all\"\r\nconst RECOMMEND = \"recommend\"\r\nconst DISGUSTING = \"disgusting\"\r\n\r\nexport default {\r\n  props: {\r\n    food: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    text: {\r\n      type: Object,\r\n      default() {\r\n        return {\r\n          recommend: \"推荐\",\r\n          disgusting: \"吐槽\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      ratingList: [],\r\n      tempCheckedList: [],\r\n      checked: false,\r\n      ratingType: ALL\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    food: function () {\r\n      //存放某种类型的评论\r\n      this.tempCheckedList = this.food.ratings\r\n      this.ratingList = this.food.ratings\r\n    }\r\n  },\r\n\r\n  mounted: function () {\r\n    //切换路由后，data中的数据会初始化\r\n    if (this.food.ratings) {\r\n      this.tempCheckedList = this.food.ratings\r\n      this.ratingList = this.food.ratings\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    //显示所有评论\r\n    showAll: function () {\r\n      this.ratingType = ALL\r\n      this.ratingList = this.food.ratings\r\n      this.tempCheckedList = this.ratingList\r\n      this._showContent()\r\n      //通过中央事件总线传递数据给父组件\r\n      Bus.$emit('changeratingtype', this.ratingList)\r\n    },\r\n    //显示推荐评论\r\n    showRecommend: function () {\r\n      this.ratingType = RECOMMEND\r\n      this.ratingList = this.food.ratings.filter(rating => rating.rateType === 0)\r\n      this.tempCheckedList = this.ratingList\r\n      this._showContent()\r\n      //通过中央事件总线传递数据给父组件\r\n      Bus.$emit('changeratingtype', this.ratingList)\r\n    },\r\n    //显示反对评论\r\n    showDisgusting: function () {\r\n      this.ratingType = DISGUSTING\r\n      this.ratingList = this.food.ratings.filter(rating => rating.rateType === 1)\r\n      this.tempCheckedList = this.ratingList\r\n      this._showContent()\r\n      //通过中央事件总线传递数据给父组件\r\n      Bus.$emit('changeratingtype', this.ratingList)\r\n    },\r\n    //内部方法，判断是否应该只显示有内容评论\r\n    _showContent: function () {\r\n      if (this.checked) {\r\n        this.ratingList = this.ratingList.filter(rating => !!rating.text === true)\r\n      }\r\n      else {\r\n        return\r\n      }\r\n    },\r\n    //显示有内容的评论\r\n    showContent: function () {\r\n      this.checked = !this.checked\r\n      if (this.checked) {\r\n        this.ratingList = this.ratingList.filter(rating => !!rating.text === true)\r\n      }\r\n      else {\r\n        //如果取消内容勾选，则显示当前类型的所有评论\r\n        this.ratingList = this.tempCheckedList\r\n      }\r\n      //通过中央事件总线传递数据给父组件\r\n      Bus.$emit('changeratingtype', this.ratingList)\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    recommend: function () {\r\n      const length = this.food.ratings.length\r\n      let recommendNumber = 0\r\n      for (let i = 0; i < length; i++) {\r\n        const rating = this.food.ratings[i]\r\n        if (rating.rateType === 0) {\r\n          recommendNumber++\r\n        }\r\n      }\r\n      return recommendNumber\r\n    },\r\n    disgusting: function () {\r\n      const length = this.food.ratings.length\r\n      let disgustingNumber = 0\r\n      for (let i = 0; i < length; i++) {\r\n        const rating = this.food.ratings[i]\r\n        if (rating.rateType === 1) {\r\n          disgustingNumber++\r\n        }\r\n      }\r\n      return disgustingNumber\r\n    }\r\n  },\r\n\r\n  components: {\r\n    // eslint-disable-next-line\r\n    Bus\r\n  }\r\n}\r\n",null]}